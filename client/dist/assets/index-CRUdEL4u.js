const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/login-R-grYQ2w.js","assets/vendor-Dp7SZ6lv.js","assets/scanner-vendor-DfxRpMWJ.js","assets/pdf-vendor-DjsH35t9.js","assets/Dashboard-D9wvQgOz.js","assets/ConfirmationModal-F3FTNoeb.js","assets/POS.styles-D5dfWbaN.js","assets/UserManagement-BZi-I1OU.js","assets/InventoryManagement-DDNn4g6v.js","assets/PedidosYApartados-2nxDrK2R.js","assets/ClientesYCreditos-BV1ZLVG6.js","assets/SalesHistoryModal-CX3SuSdS.js","assets/AlertModal-BThKNu9Y.js","assets/Finances-CSGjDj_i.js","assets/POS-urnN6Ryl.js","assets/Reports-DVc9dtsk.js","assets/Unauthorized-C0jN85F-.js","assets/InventoryUpload-CTA9dWDQ.js","assets/CashReport-C8RrUoTs.js","assets/FacturasProveedores-YMf0HrvM.js","assets/Solicitudes-Bpq6BPbH.js","assets/InventoryOutflowPage-Z_ZwCD-Q.js","assets/DetailedSalesReport-b_sTLE8M.js","assets/SettingsPage-DkdX0nfp.js"])))=>i.map(i=>d[i]);
import{a as me,r as c,b as he,j as r,R as v,N as J,c as ye,F as je,A as xe,d as we,e as _,m as S,l as ve,f as _e,B as Se}from"./vendor-Dp7SZ6lv.js";import{_ as E}from"./pdf-vendor-DjsH35t9.js";import"./scanner-vendor-DfxRpMWJ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const w of a.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const ie="/api",dt=ie,Ee=15e3,Ae=2,l=async(e,t,n=null,s=null,o={})=>{var R,z;const a={"Content-Type":"application/json",...o.headers||{}};n&&(a.Authorization=`Bearer ${n}`);const w=`${ie}${t}`,j=String(e||"get").toLowerCase(),D=j==="get"?Ae:0;for(let P=0;P<=D;P++)try{const h={url:w,method:j,headers:a,timeout:o.timeout||Ee,withCredentials:!!o.withCredentials,...o};return s!==null&&j!=="get"&&(h.data=s),o.params&&j==="get"&&(h.params=o.params),(await me.request(h)).data}catch(h){if(h.response){const i=((R=h.response.data)==null?void 0:R.message)||((z=h.response.data)==null?void 0:z.msg)||JSON.stringify(h.response.data),p=new Error(i||`HTTP ${h.response.status}`);throw p.status=h.response.status,p}if(P>=D){const i=new Error(h.code==="ECONNABORTED"?"Tiempo de espera agotado. Verifica tu conexiÃ³n a internet.":h.message||"Error de conexiÃ³n con el servidor.");throw i.isNetworkError=!0,i}const m=500*Math.pow(2,P);console.warn(`âš ï¸ Reintentando ${t} (intento ${P+2}/${D+1}) en ${m}ms...`),await new Promise(i=>setTimeout(i,m))}},ut=async e=>{const{username:t,nombre_usuario:n,password:s}=e;return await l("post","/auth/login",null,{nombre_usuario:n??t,password:s})},ee=async e=>await l("get","/users",e),te=async e=>{const t=await l("get","/products",e);return(Array.isArray(t)?t:[]).map(s=>({id:s.id_producto??s.id??s._id,id_producto:s.id_producto??s.id??s._id,codigo:s.codigo??s.code??"",nombre:s.nombre??s.nombre_producto??s.name??"Sin nombre",precio:Number(s.venta??s.precio??s.price??0),precio_venta:Number(s.venta??s.precio??s.price??0),existencia:Number(s.existencia??s.stock??0),imagen:s.imagen||null,descripcion:s.descripcion||"",categoria:s.nombre_categoria||"",costo:Number(s.costo||0),mayorista:Number(s.mayoreo||s.mayorista||0),raw:s}))},se=async e=>{const t=await l("get","/clients",e),n=Array.isArray(t)?t:[],s=n.find(a=>(a.nombre||"").toLowerCase().includes("contado")),o=n.filter(a=>s?a.id_cliente!==s.id_cliente:!0);return s?[s,...o]:n},Ie=async e=>await l("get","/categories",e),Ce=async e=>await l("get","/providers",e),ft=async(e,t=null)=>{const n={};return t&&(n.params={date:t}),await l("get","/sales",e,null,n)},gt=async(e,t)=>await l("post","/sales",t,e),pt=async(e,t)=>await l("post","/sales/returns",t,e),mt=async(e,t)=>await l("delete",`/sales/${e}`,t),Ne=async e=>await l("GET","/orders/pending",e),ht=(e,t)=>l("POST","/clients",t,e),yt=(e,t,n)=>l("PUT",`/clients/${e}`,n,t),jt=(e,t)=>l("DELETE",`/clients/${e}`,t),xt=(e,t,n)=>l("POST",`/clients/${e}/abono`,n,t),wt=(e,t)=>l("GET",`/clients/${e}/creditos`,t),vt=(e,t)=>l("GET",`/clients/${e}/abonos`,t),_t=(e,t)=>l("GET",`/clients/${e}/creditos-pendientes`,t),St=(e,t)=>l("get","/reports/sales-summary",e,null,{params:t}),Et=e=>l("get","/reports/inventory-value",e),At=(e,t)=>l("get","/reports/sales-by-user",e,null,{params:t}),It=(e,t)=>l("get","/reports/top-products",e,null,{params:t}),Ct=(e,t)=>l("get","/reports/sales-chart",e,null,{params:t}),Nt=async(e,t)=>await l("post","/upload/inventory",t,e),Re=async(e,t)=>{const n=localStorage.getItem("token");return await l("get","/caja/session",n,null,{params:{userId:e}})},Rt=async(e,t)=>await l("post","/caja/session/open",t,e),De=async(e,t)=>await l("post","/caja/session/tx",t,e),Dt=async(e,t)=>await l("post","/caja/session/close",t,e),Ot=async e=>await l("get","/caja/abiertas/activas",e),Tt=async e=>await l("get","/facturas-proveedores",e),Pt=async(e,t)=>await l("post","/facturas-proveedores",t,e),bt=async(e,t,n)=>await l("post",`/facturas-proveedores/${e}/pagar`,n,{amount:t}),Lt=async(e,t)=>await l("delete",`/facturas-proveedores/${e}`,t),re=async(e,t)=>await l("get","/caja/cart",t,null,{params:{userId:e}}),Oe=async(e,t,n)=>await l("post","/caja/cart",n,{userId:e,carts:t}),kt=async e=>await l("get","/requests",e),zt=async(e,t)=>await l("post","/requests",t,e),$t=async(e,t,n)=>await l("put",`/requests/${e}/toggle`,n,{completed:t}),Ut=async(e,t,n)=>await l("put",`/requests/${e}`,n,{descripcion:t}),Vt=async(e,t)=>await l("delete",`/requests/${e}`,t),Mt=async(e,t)=>await l("post","/outflow",t,e),Bt=async e=>await l("get","/outflow/history",e),Te=e=>{const t=e instanceof Date?e:new Date(e),n=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-n).toISOString().split("T")[0]},Z=(e,t)=>`caja_session_${e}_${Te(t)}`,K=e=>`caja_session_index_${e}`,ne=(e,t)=>{if(!e){const o=String(t??"").trim();return o?{id:o,name:`Usuario ${o}`}:null}if(typeof e!="object")return{name:String(e)};const n=String(e.id??t??"").trim(),s=e.name??e.nombre??e.fullName??e.displayName??e.nombre_usuario??e.username??(n?`Usuario ${n}`:void 0);return{...e,...n?{id:n}:{},...s?{name:s}:{}}},oe=e=>{if(!e)return null;try{const t=localStorage.getItem(K(e));if(t){const s=localStorage.getItem(t);if(s)return JSON.parse(s)}const n=localStorage.getItem(Z(e,new Date));return n?JSON.parse(n):be(e)}catch(t){return console.error("Error al cargar la sesiÃ³n de caja:",t),null}},Pe=(e,t)=>{var n;if(!(!e||!t))try{const s={...t};s.openedBy&&(s.openedBy=ne(s.openedBy,e)),s.closedBy&&(s.closedBy=ne(s.closedBy,((n=s.closedBy)==null?void 0:n.id)||e));const o=s.openedAt?new Date(s.openedAt):new Date,a=Z(e,o);localStorage.setItem(a,JSON.stringify(s)),localStorage.setItem(K(e),a)}catch(s){console.error("Error al guardar la sesiÃ³n de caja:",s)}},be=e=>{if(!e)return null;try{const t=new Date;for(let n=1;n<=7;n++){const s=new Date(t);s.setDate(t.getDate()-n);const o=Z(e,s),a=localStorage.getItem(o);if(a){const w=JSON.parse(a);if(w&&!w.closedAt)return localStorage.setItem(K(e),o),w}}return null}catch(t){return console.error("Error buscando sesiones antiguas:",t),null}},ce=c.createContext(null),Le=({children:e,socket:t})=>{const[n,s]=c.useState(null),[o,a]=c.useState([]),[w,j]=c.useState([]),[k,D]=c.useState([]),[R,z]=c.useState([]),[P,h]=c.useState([]),[O,m]=c.useState(!0),i=he(),[p,x]=c.useState(()=>localStorage.getItem("token")),[u,T]=c.useState(null),A=c.useRef(null),I=c.useCallback(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),s(null),x(null),i("/login")},[i]),H="masterDataCache",V=c.useCallback(async(f,y=!1)=>{try{const g=await Promise.allSettled([ee(f),te(f),se(f),Ie(f),Ce(f)]),b=g[0].status==="fulfilled"?g[0].value||[]:null,$=g[1].status==="fulfilled"?g[1].value||[]:null,U=g[2].status==="fulfilled"?g[2].value||[]:null,N=g[3].status==="fulfilled"?g[3].value||[]:null,G=g[4].status==="fulfilled"?g[4].value||[]:null;b&&a(b),$&&j($),U&&D(U),N&&z(N),G&&h(G);try{const M={users:b||[],products:$||[],clients:U||[],categories:N||[],providers:G||[],timestamp:Date.now()};localStorage.setItem(H,JSON.stringify(M))}catch{}g.every(M=>{var X;return M.status==="rejected"&&((X=M.reason)==null?void 0:X.status)===401})&&I()}catch(g){console.error("Fallo crÃ­tico cargando datos maestros:",g),g.status===401&&I()}},[I]),Y=c.useCallback(()=>{var f,y,g,b,$;try{const U=localStorage.getItem(H);if(U){const N=JSON.parse(U);return(f=N.users)!=null&&f.length&&a(N.users),(y=N.products)!=null&&y.length&&j(N.products),(g=N.clients)!=null&&g.length&&D(N.clients),(b=N.categories)!=null&&b.length&&z(N.categories),($=N.providers)!=null&&$.length&&h(N.providers),!0}}catch{}return!1},[]),q=c.useCallback(async()=>{if(p)try{const f=await te(p);j(f||[])}catch(f){f.name!=="CanceledError"&&console.error("Error updating inventory:",f.message)}},[p]),Q=c.useCallback(()=>{A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{q()},300)},[q]),B=c.useCallback(async()=>{const f=localStorage.getItem("token");if(f)try{const y=await se(f);D(y||[])}catch{}},[]);c.useEffect(()=>{if(!t)return;const f=()=>{Q()};return t.on("inventory_update",f),t.on("products:update",f),t.on("clients:update",B),t.on("users:update",async()=>{const y=localStorage.getItem("token");if(y)try{const g=await ee(y);a(g||[])}catch{}}),()=>{A.current&&clearTimeout(A.current),t.off("inventory_update",f),t.off("products:update",f),t.off("clients:update",B),t.off("users:update")}},[t,Q,B]),c.useEffect(()=>{(async()=>{m(!0);try{const y=localStorage.getItem("token"),g=localStorage.getItem("user");if(y&&g)try{const b=JSON.parse(g);s(b),x(y),Y()?(m(!1),V(y,!0).catch(console.warn)):(await V(y),m(!1))}catch{I()}}finally{m(y=>y&&!1)}})()},[I,V,Y]);const fe=async(f,y)=>{localStorage.setItem("token",y),localStorage.setItem("user",JSON.stringify(f)),s(f),x(y),m(!0),await V(y),m(!1),i("/dashboard")};c.useEffect(()=>{if(n){const f=n.id_usuario||n.id;T(oe(f))}else T(null)},[n]);const ge=c.useCallback(async f=>{if(!n)return;const y=n.id_usuario||n.id,g=oe(y);g&&!g.closedAt&&(g.transactions=[...g.transactions||[],f],Pe(y,g),T(g));try{await De({userId:y,tx:f},p)}catch(b){console.error("âŒ Error sincronizando transacciÃ³n de caja:",b)}},[n,p]),pe={user:n,token:p,allUsers:o,products:w,clients:k,categories:R,providers:P,isLoading:O,login:fe,logout:I,loadMasterData:V,refreshProducts:q,refreshClients:B,cajaSession:u,setCajaSession:T,addCajaTransaction:ge};return O&&!n?r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"#f8fafc",color:"#64748b"},children:[r.jsx("div",{className:"spinner",style:{width:"50px",height:"50px",border:"5px solid #e2e8f0",borderTop:"5px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),r.jsx("h3",{style:{marginTop:"20px",fontWeight:600},children:"Cargando Sistema..."}),r.jsx("style",{children:`
                    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                `})]}):r.jsx(ce.Provider,{value:pe,children:e})},F=()=>{const e=c.useContext(ce);if(!e)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return e},le=c.createContext(null),ke=({children:e,user:t,socket:n})=>{const s=(t==null?void 0:t.id_usuario)||(t==null?void 0:t.id),[o,a]=c.useState(!1),[w,j]=c.useState(null),[k,D]=c.useState(36.6),R=c.useCallback(async()=>{var h,O;if(s)try{const m=await Re(s);m&&!m.closedAt?(j(m),a(!0),m.tasaDolar&&D(Number(m.tasaDolar))):(j(null),a(!1))}catch(m){if(m.isNetworkError||(h=m.message)!=null&&h.includes("timeout")||(O=m.message)!=null&&O.includes("conexiÃ³n")||!m.status){console.warn("âš ï¸ Error de red al sincronizar caja (manteniendo estado actual):",m.message);return}console.error("âŒ Error de servidor al sincronizar caja:",m),j(null),a(!1)}},[s]);c.useEffect(()=>{if(!s){a(!1),j(null);return}if(R(),n){const O=i=>{(!i||!i.userId||i.userId===s)&&(console.log("âš¡ Socket: caja session update"),R())},m=i=>{(!i||!i.userId||i.userId===s)&&(console.log("âš¡ Socket: New Tx"),R())};return n.on("caja:session_update",O),n.on("caja:transaction_new",m),()=>{n.off("caja:session_update",O),n.off("caja:transaction_new",m)}}const h=setInterval(R,15e3);return()=>{clearInterval(h)}},[s,R,n]);const P={isCajaOpen:o,setIsCajaOpen:a,cajaSession:w,setCajaSession:j,tasaDolar:k,setTasaDolar:D,closeCajaSession:()=>{s&&(j(null),a(!1))},refreshSession:R};return r.jsx(le.Provider,{value:P,children:e})},Ft=()=>{const e=c.useContext(le);if(!e)throw new Error("useCaja must be used within CajaProvider");return e},de=c.createContext(null),ze=({children:e})=>{const[t,n]=c.useState([]),[s,o]=c.useState(null),[a,w]=c.useState(null),j=t.find(i=>i.id===s)||{items:[]},k=c.useCallback(async i=>{if(!i)return;w(i);try{const x=localStorage.getItem("token"),u=await re(i,x);if(u&&Array.isArray(u)&&u.length>0){n(u),o(u[0].id);return}}catch(x){console.error("Error loading carts from DB, falling back to local:",x)}const p=[{id:Date.now(),name:"Ticket 1",items:[]}];n(p),o(p[0].id)},[]);c.useEffect(()=>{if(a&&t.length>0){const i=setTimeout(()=>{const p=localStorage.getItem("token");Oe(a,t,p).catch(x=>console.error("Error saving cart:",x))},1e3);return()=>clearTimeout(i)}},[t,a]);const D=()=>{const i={id:Date.now(),name:`Ticket ${t.length+1}`,items:[]};n(p=>[...p,i]),o(i.id)},R=i=>{h.current&&(h.current.add(String(i)),setTimeout(()=>{h.current&&h.current.delete(String(i))},1e4));let p=[];n(u=>{const T=u.filter(A=>A.id!==i);if(T.length===0){const A={id:Date.now(),name:"Ticket 1",items:[]};p=[A],A.id}else p=T,s===i&&T[0].id;return p});const x=t.filter(u=>u.id!==i);if(x.length===0){const u={id:Date.now(),name:"Ticket 1",items:[]};n([u]),o(u.id)}else n(x),s===i&&o(x[0].id)},z=(i,p)=>{n(x=>x.map(u=>u.id===s?{...u,[i]:p}:u))},P=async()=>{try{const i=localStorage.getItem("token"),p=await Ne(i);if(p&&p.length>0){const x=p.map(u=>({id:`server_${u.id_pedido}`,serverSaleId:u.id_pedido,name:`Pedido #${u.id_pedido}`,items:u.items||[],client:u.cliente}));n(u=>{const T=new Set(u.map(I=>I.id)),A=x.filter(I=>!T.has(I.id));return[...u,...A]})}}catch(i){console.error("Error loading pending orders",i)}},h=v.useRef(new Set),O=c.useCallback(async i=>{if(i)try{const p=localStorage.getItem("token"),x=await re(i,p);x&&Array.isArray(x)&&n(u=>{const T=new Set(u.map(I=>I.id)),A=x.filter(I=>!T.has(I.id)&&!h.current.has(String(I.id)));return A.length>0?[...u,...A]:u})}catch{}},[]),m={orders:t,setOrders:n,activeOrderId:s,setActiveOrderId:o,activeOrder:j,handleNewOrder:D,handleRemoveOrder:R,updateActiveOrder:z,loadOrdersFromDB:k,loadPendingOrdersFromServer:P,checkForNewOrders:O};return r.jsx(de.Provider,{value:m,children:e})},qt=()=>{const e=c.useContext(de);if(!e)throw new Error("useOrders must be used within OrdersProvider");return e},W="/api",$e=async e=>{try{const t=await fetch(`${W}/settings`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok){const s=await t.text();return console.warn("Settings API Error:",t.status,s.substring(0,100)),null}const n=t.headers.get("content-type");return!n||!n.includes("application/json")?(console.warn("Settings API returned non-JSON:",n),null):await t.json()}catch(t){return console.error("getSettings error:",t),null}},Gt=async(e,t)=>{const n=await fetch(`${W}/settings`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!n.ok)throw new Error("Error al actualizar configuraciÃ³n");return await n.json()},Jt=async(e,t)=>new Promise((n,s)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=async()=>{try{const a=await fetch(`${W}/settings/logo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({logo:o.result})});if(!a.ok)throw new Error("Error subiendo logo");const w=await a.json();n(w.logoUrl)}catch(a){s(a)}},o.onerror=a=>s(a)}),ue=c.createContext(),Ue=({children:e})=>{const{token:t}=F(),[n,s]=c.useState({empresa_nombre:"Multirepuestos RG",empresa_ruc:"1211812770001E",empresa_telefono:"84031936 / 84058142",empresa_direccion:"Del portÃ³n de la normal 75 varas al este. Juigalpa, Chontales.",empresa_eslogan:"Repuestos de confianza al mejor precio â€” calidad que mantiene tu motor en marcha.",empresa_logo_url:""}),[o,a]=c.useState(!0),w=async()=>{if(t)try{const j=await $e(t);j&&s(k=>({...k,...j}))}catch(j){console.error("Error loading settings:",j)}finally{a(!1)}};return c.useEffect(()=>{w()},[t]),r.jsx(ue.Provider,{value:{settings:n,refreshSettings:w,loading:o},children:e})},Zt=()=>c.useContext(ue),C=({children:e,allowedRoles:t})=>{const{user:n,isLoading:s}=F();return s?r.jsx("div",{style:{padding:"2rem"},children:"Cargando..."}):n?t&&Array.isArray(t)&&!t.includes(n.rol)?r.jsx(J,{to:"/unauthorized",replace:!0}):e:r.jsx(J,{to:"/login",replace:!0})},Ve=v.lazy(()=>E(()=>import("./login-R-grYQ2w.js"),__vite__mapDeps([0,1,2,3]))),Me=v.lazy(()=>E(()=>import("./Dashboard-D9wvQgOz.js"),__vite__mapDeps([4,3,1,2,5,6]))),Be=v.lazy(()=>E(()=>import("./UserManagement-BZi-I1OU.js"),__vite__mapDeps([7,1,2]))),Fe=v.lazy(()=>E(()=>import("./InventoryManagement-DDNn4g6v.js"),__vite__mapDeps([8,1,2]))),qe=v.lazy(()=>E(()=>import("./PedidosYApartados-2nxDrK2R.js"),__vite__mapDeps([9,1,2,3]))),Ge=v.lazy(()=>E(()=>import("./ClientesYCreditos-BV1ZLVG6.js"),__vite__mapDeps([10,1,2,11,6,12,3]))),Je=v.lazy(()=>E(()=>import("./Finances-CSGjDj_i.js"),__vite__mapDeps([13,1,2,12,6]))),Ze=v.lazy(()=>E(()=>import("./POS-urnN6Ryl.js"),__vite__mapDeps([14,1,2,6,11,12,5,3]))),Ke=v.lazy(()=>E(()=>import("./Reports-DVc9dtsk.js"),__vite__mapDeps([15,1,2,12,6,3]))),We=v.lazy(()=>E(()=>import("./Unauthorized-C0jN85F-.js"),__vite__mapDeps([16,1,2]))),He=v.lazy(()=>E(()=>import("./InventoryUpload-CTA9dWDQ.js"),__vite__mapDeps([17,1,2,3]))),Ye=v.lazy(()=>E(()=>import("./CashReport-C8RrUoTs.js"),__vite__mapDeps([18,1,2,3]))),Qe=v.lazy(()=>E(()=>import("./FacturasProveedores-YMf0HrvM.js"),__vite__mapDeps([19,1,2,3]))),Xe=v.lazy(()=>E(()=>import("./Solicitudes-Bpq6BPbH.js"),__vite__mapDeps([20,1,2,3]))),et=v.lazy(()=>E(()=>import("./InventoryOutflowPage-Z_ZwCD-Q.js"),__vite__mapDeps([21,1,2,3]))),tt=v.lazy(()=>E(()=>import("./DetailedSalesReport-b_sTLE8M.js"),__vite__mapDeps([22,1,2,3]))),st=v.lazy(()=>E(()=>import("./SettingsPage-DkdX0nfp.js"),__vite__mapDeps([23,1,2,3]))),ae=()=>r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"#64748b"},children:"Cargando..."}),d={ADMIN:"Administrador",VENDEDOR:"Vendedor",INVENTARIO:"Encargado de Inventario",FINANZAS:"Encargado de Finanzas",GERENTE:"Gerente",EMPLEADO:"Empleado"};function rt(){const{user:e,isLoading:t}=F(),n=ye();if(t)return r.jsx(ae,{});const s={initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2,ease:"easeOut"}};return r.jsxs(v.Suspense,{fallback:r.jsx(ae,{}),children:[r.jsx(je,{position:"top-center",reverseOrder:!1}),r.jsx(xe,{mode:"wait",children:r.jsxs(we,{location:n,children:[r.jsx(_,{path:"/login",element:r.jsx(S.div,{...s,children:r.jsx(Ve,{})})}),r.jsx(_,{path:"/unauthorized",element:r.jsx(S.div,{...s,children:r.jsx(We,{})})}),r.jsx(_,{path:"/dashboard",element:r.jsx(C,{children:r.jsx(S.div,{...s,children:r.jsx(Me,{})})})}),r.jsx(_,{path:"/pos",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.VENDEDOR],children:r.jsx(S.div,{...s,children:r.jsx(Ze,{})})})}),r.jsx(_,{path:"/inventory",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.INVENTARIO],children:r.jsx(S.div,{...s,children:r.jsx(Fe,{})})})}),r.jsx(_,{path:"/orders",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.VENDEDOR,d.EMPLEADO],children:r.jsx(S.div,{...s,children:r.jsx(qe,{})})})}),r.jsx(_,{path:"/credits",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.VENDEDOR,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(Ge,{})})})}),r.jsx(_,{path:"/finances",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(Je,{})})})}),r.jsx(_,{path:"/reports",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.GERENTE,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(Ke,{})})})}),r.jsx(_,{path:"/admin/users",element:r.jsx(C,{allowedRoles:[d.ADMIN],children:r.jsx(S.div,{...s,children:r.jsx(Be,{})})})}),r.jsx(_,{path:"/upload/inventory",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.INVENTARIO],children:r.jsx(S.div,{...s,children:r.jsx(He,{})})})}),r.jsx(_,{path:"/cash-report",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.GERENTE,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(Ye,{})})})}),r.jsx(_,{path:"/traslados",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.INVENTARIO],children:r.jsx(S.div,{...s,children:r.jsx(et,{})})})}),r.jsx(_,{path:"/detailed-sales-report",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.GERENTE,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(tt,{})})})}),r.jsx(_,{path:"/invoices",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.FINANZAS],children:r.jsx(S.div,{...s,children:r.jsx(Qe,{})})})}),r.jsx(_,{path:"/solicitudes",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.VENDEDOR,d.INVENTARIO,d.FINANZAS,d.GERENTE],children:r.jsx(S.div,{...s,children:r.jsx(Xe,{})})})}),r.jsx(_,{path:"/settings",element:r.jsx(C,{allowedRoles:[d.ADMIN,d.GERENTE],children:r.jsx(S.div,{...s,children:r.jsx(st,{})})})}),r.jsx(_,{path:"*",element:r.jsx(J,{to:e?"/dashboard":"/login",replace:!0})})]},n.pathname)})]})}const nt=window.location.host.includes("localhost")?"http://localhost:3001":window.location.origin,L=ve(nt,{path:"/api/socket.io/",transports:["polling","websocket"],reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,autoConnect:!0,withCredentials:!0});L.on("connect",()=>{console.log("âœ… Socket Connected (v2.1):",L.id),console.log("ðŸš€ Connection Transport:",L.io.engine.transport.name)});L.io.engine.on("upgrade",e=>{console.log("ðŸš€ Transport Upgraded to:",e.name)});L.on("connect_error",e=>{console.warn("âš ï¸ Socket Connection Error:",e.message)});L.on("disconnect",e=>{console.warn("âŒ Socket Disconnected:",e),e==="io server disconnect"&&L.connect()});const ot=({socket:e})=>{const{user:t}=F();return r.jsx(ke,{user:t,socket:e,children:r.jsx(Ue,{children:r.jsx(ze,{children:r.jsx(rt,{})})})})};"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){for(let t of e)t.unregister(),console.log("Service Worker Unregistered to force update")});_e.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(Se,{children:r.jsx(Le,{socket:L,children:r.jsx(ot,{socket:L})})})}));export{Et as A,At as B,It as C,Ct as D,Nt as E,Tt as F,dt as G,Pt as H,bt as I,Lt as J,kt as K,zt as L,$t as M,Ut as N,Vt as O,Mt as P,Bt as Q,Zt as a,Jt as b,Gt as c,te as d,yt as e,Ot as f,re as g,ht as h,_t as i,wt as j,vt as k,ut as l,Ft as m,ft as n,jt as o,qt as p,Dt as q,Rt as r,Oe as s,pt as t,F as u,mt as v,De as w,gt as x,xt as y,St as z};
